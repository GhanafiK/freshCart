<section class="bg-main-light p-2 my-5 rounded-4 text-main forgot ">
  <h1 class="h2 text-center forgot-text">Forgot Password</h1>
  <form [formGroup]="verifyEmail" (ngSubmit)="onverifyEmail()" #verifyemail >
    <div class="my-2">
      <label for="emailVerify">email:</label>
      <input type="email" name="email" id="emailVerify" class="form-control" formControlName="email" [ngClass]="
      {
        'is-valid':!verifyEmail.get('email')?.errors&&(verifyEmail.get('email')?.touched||verifyEmail.get('email')?.dirty),
        'is-invalid':errMsg||(verifyEmail.get('email')?.errors&&(verifyEmail.get('email')?.touched||verifyEmail.get('email')?.dirty))
      }
      ">

      @if(verifyEmail.get('email')?.errors&&(verifyEmail.get('email')?.touched||verifyEmail.get('email')?.dirty)){
        <div class="w-100 alert alert-danger p-1 text-center mt-2 mb-0 small fw-bolder">
          @if (verifyEmail.get('email')?.getError('required')) {
            <p class="m-0">email is required.</p>
          }
          @else if (verifyEmail.get('email')?.getError('email')) {
            <p class="m-0">Please enter a valid email address</p>
          }
        </div>
      }
    </div>

    @if(errMsg&&!isloading){
      <div class="w-100 alert alert-danger p-1 text-center mt-2 mb-0 small fw-bolder">
        {{errMsg}}
      </div>
    }

    <button class="btn-main w-100 "  [disabled]="isloading" type="submit">
      Verify Email
      @if(isloading){
        <span><i class="fas fa-spin fa-spinner"></i></span>
      }
    </button>
  </form>

  <form [formGroup]="verifyCode" (ngSubmit)="onVerifyCode()" class="d-none" #verifycode>
    <div class="my-2">
      <label for="resetCode">resetCode:</label>
      <input type="text" name="resetCode" id="resetCode" class="form-control" formControlName="resetCode" [ngClass]="
      {
        'is-valid':!verifyCode.get('resetCode')?.errors&&(verifyCode.get('resetCode')?.touched||verifyCode.get('resetCode')?.dirty),
        'is-invalid':errMsg||(verifyCode.get('resetCode')?.errors&&(verifyCode.get('resetCode')?.touched||verifyCode.get('resetCode')?.dirty))
      }
      ">

      @if(verifyCode.get('resetCode')?.getError('required')&&(verifyCode.get('resetCode')?.touched||verifyCode.get('resetCode')?.dirty)){
        <div class="w-100 alert alert-danger p-1 text-center mt-2 mb-0 small fw-bolder">
          @if (verifyCode.get('resetCode')?.getError('required')) {
            <p class="m-0">resetCode is required.</p>
          }
        </div>
      }
    </div>
    @if(errMsg){
      <div class="w-100 alert alert-danger p-1 text-center mt-2 mb-0 small fw-bolder">
        {{errMsg}}
      </div>
    }
    <button class="btn-main w-100"  type="submit">
      Verify Code
    </button>
  </form>

  <form [formGroup]="resetPassword" (ngSubmit)="onResetPassword()" class="d-none" #resetpass>
    <div class="my-2">
      <label for="email">email:</label>
      <input type="email" name="email" id="email" class="form-control" formControlName="email" readonly>
    </div>

    <div class="my-2">
      <label for="newPassword">newPassword:</label>
      <input type="password" id="newPassword" formControlName="newPassword" class="form-control" [ngClass]="
      {
        'is-valid':!resetPassword.get('newPassword')?.errors&&(resetPassword.get('newPassword')?.touched||resetPassword.get('newPassword')?.dirty),
        'is-invalid':errMsg||(resetPassword.get('newPassword')?.errors&&(resetPassword.get('newPassword')?.touched||resetPassword.get('newPassword')?.dirty))
      }
        
      ">

      @if (resetPassword.get('newPassword')?.errors&&(resetPassword.get('newPassword')?.touched||resetPassword.get('newPassword')?.dirty)) {
        <div class="w-100 alert alert-danger p-1 text-center mt-2 mb-0 small fw-bolder">
          @if(resetPassword.get('newPassword')?.getError('required')){
            <p class="m-0">password is required.</p>
          }@else if (resetPassword.get('newPassword')?.getError('pattern')) {
            <p class="m-0">Password must be at least 6 characters long.</p>
          }
        </div>
      }
    </div>

    @if(errMsg){
      <div class="w-100 alert alert-danger p-1 text-center mt-2 mb-0 small fw-bolder">
        {{errMsg}}
      </div>
    }

    <button class="btn-main w-100"  type="submit">
      Reset Password
    </button>
  </form>

</section>
